
@model Connect4m_Web.Models.ManageUsersModel

@{
    ViewData["Title"] = "UserSearchTab";
    Layout = null;
}
@*<link href="~/Datatable/jquery.dataTables.css" rel="stylesheet" />*@
<link href="~/css/CommonStyle.css" rel="stylesheet" />
<style>
    #appendforinsertsalaryattribute {
        display: none;
    }
</style>
<div class="col-sm-12 ">

    <div class="card">

        <div class="card-body">
            <div class="default-according style-1" id="accordionoc">
                <div class="card">
                    <h6><span>MANAGE USERS</span></h6>


                    <div class="card-header pb-0">
                        <button class="btn btn-pill btn-outline-primary btn-aprimary" style=" margin-left: 68%; border-radius: 15px; height: 35px;  margin-bottom: 3px;" id="addnewsalaryattributebtn">
                            Create User
                        </button>

                    </div>
                    <div id="appendsearchsalaryattribute">

                        <div class="card-header bg-primary">
                            <h5 class="mb-0">
                                <button class="btn btn-link text-white" data-bs-toggle="collapse" data-bs-target="#collapseicon" aria-expanded="true" aria-controls="collapse11">SEARCH USERS</button>
                            </h5>
                        </div>
                        <div class="collapse show" id="collapseicon" aria-labelledby="collapseicon" data-bs-parent="#accordionoc">

                            <div class="row padding-search">
                                <div class="row">

                                    <form id="FmUsersSearch">
                                        @*<div asp-validation-summary="ModelOnly" class="text-danger"></div>*@
                                        <input type="text" asp-for="UserId" name="UserId" id="UserIdMe" hidden style="display:none" readonly />

                                        <div class="row">
                                            <div class="form-group col-12 passwordfor"><span class="compare"></span></div>
                                            @*----------------------*@

                                            <div class="form-group col-2">
                                                <label asp-for="UserName" class="control-label  space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="UserName" class="form-control" id="AdmissionNumber_ME" />
                                                <span asp-validation-for="UserName" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@

                                            <div class="form-group col-2">
                                                <label asp-for="InstanceUserCode" class="control-label space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="InstanceUserCode" class="form-control" id="SalaryAttributeName" />
                                            </div>

                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="RoleId" class="control-label space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <div id="Drop_Format_SEM_3">
                                                    @Html.DropDownListFor(x => x.RoleId,
                                                new SelectList(ViewBag.SalaryAttributeType, "Value", "Text"), "-------select-------", new { @class = "form-select readonly", @id = "dropdown_SalaryAttributeType_CSA", @style = "color:black;" })
                                                </div>
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="AdmissionNumber" class="control-label space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="AdmissionNumber" class="form-control" id="SalaryAttributeName" />
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="FirstName" class="control-label space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="FirstName" class="form-control" id="StartDate" />
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="LastName" class="control-label space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="LastName" class="form-control" id="EndDate" />
                                            </div>

                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="InstanceClassificationId" class="control-label space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <div id="Drop_Format_SEM_3">
                                                    @Html.DropDownListFor(x => x.InstanceClassificationId, new SelectList(ViewBag.SalaryAttributeType, "Value", "Text"), "-------select-------", new { @class = "form-select readonly", @id = "dropdown_SalaryAttributeType_CSA", @style = "color:black;" })
                                                </div>
                                            </div>

                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="InstanceSubClassificationId" class="control-label  space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                @Html.DropDownListFor(x => x.InstanceSubClassificationId, new SelectList(ViewBag.SalaryAttributeType, "Value", "Text"), "-------select-------", new { @class = "form-select readonly", @id = "dropdown_SalaryAttributeType_CSA", @style = "color:black;" })

                                                <span asp-validation-for="InstanceSubClassificationId" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="RouteId" class="control-label space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <div id="Drop_Format_SEM_3">
                                                    @Html.DropDownListFor(x => x.RouteId, new SelectList(ViewBag.SalaryAttributeType, "Value", "Text"), "-------select-------", new { @class = "form-select readonly", @id = "dropdown_SalaryAttributeType_CSA", @style = "color:black;" })
                                                </div>
                                            </div>


                                            @*----------------------*@

                                            <div class="form-group col-2">
                                                <label asp-for="StopId" class="control-label  space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                @Html.DropDownListFor(x => x.StopId, new SelectList(ViewBag.SalaryAttributeType, "Value", "Text"), "-------select-------", new { @class = "form-select readonly", @id = "dropdown_SalaryAttributeType_CSA", @style = "color:black;" })

                                                <span asp-validation-for="StopId" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="CollegeCode" class="control-label  space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="CollegeCode" class="form-control" id="EndDate" />
                                                <span asp-validation-for="CollegeCode" class="text-danger"></span>
                                                <span class="compare"></span>
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="Gender" class="control-label  space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                @Html.DropDownListFor(x => x.Gender, new SelectList(ViewBag.SalaryAttributeType, "Value", "Text"), "-------select-------", new { @class = "form-select readonly", @id = "dropdown_SalaryAttributeType_CSA", @style = "color:black;" })
                                                <span asp-validation-for="Gender" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="Transport" class="control-label  space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                @Html.DropDownListFor(x => x.Transport, new SelectList(ViewBag.SalaryAttributeType, "Value", "Text"), "-------select-------", new { @class = "form-select readonly", @id = "dropdown_SalaryAttributeType_CSA", @style = "color:black;" })

                                                <span asp-validation-for="Transport" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="PortalEmail" class="control-label  space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="PortalEmail" class="form-control" />
                                                <span asp-validation-for="PortalEmail" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="IsActive" class="control-label  space"></label>
                                            </div>
                                            <div class="form-group col-4" style="display:flex">
                                                <input asp-for="IsActive" type="radio" name="Gender" value="1" style="flex: 0.2;" /><span>Yes</span>
                                                <input asp-for="IsActive" type="radio" name="Gender" value="0" style="flex: 0.2;" /><span>No</span>

                                                <span asp-validation-for="IsActive" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="DesignationId" class="control-label  space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                @Html.DropDownListFor(x => x.DesignationId, new SelectList(ViewBag.SalaryAttributeType, "Value", "Text"), "-------select-------", new { @class = "form-select readonly", @id = "dropdown_SalaryAttributeType_CSA", @style = "color:black;" })

                                                <span asp-validation-for="DesignationId" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@


                                            <div class="form-group col-2">
                                                <label asp-for="MobilePhone" class="control-label  space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="MobilePhone" class="form-control" />
                                                <span asp-validation-for="MobilePhone" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                            </div>
                                            <div class="form-group col-4">
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="SearchDateType" type="radio" name="SearchDateType" value="1" style="flex: 0.2;" /><span>Withdrawal date</span>
                                                <input asp-for="SearchDateType" type="radio" name="SearchDateType" value="2" style="flex: 0.2;" /><span>Admission date</span>
                                                <input asp-for="SearchDateType" type="radio" name="SearchDateType" value="3" style="flex: 0.2;" /><span>Jooining date</span>

                                                <span asp-validation-for="SearchDateType" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@

                                            <div class="form-group col-2">
                                            </div>
                                            <div class="form-group col-4">
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="SearchStartDate" class="control-label required space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="SearchStartDate" class="form-control" />
                                                <span asp-validation-for="SearchStartDate" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@
                                            <div class="form-group col-2">
                                                <label asp-for="SearchEndDate" class="control-label required space"></label>
                                            </div>
                                            <div class="form-group col-4">
                                                <input asp-for="SearchEndDate" class="form-control" />
                                                <span asp-validation-for="SearchEndDate" class="text-danger"></span>
                                            </div>
                                            @*----------------------*@
                                            <div style=" display: flex; gap: 17px;">
                                                <div class="col-2"></div>
                                                @*<input type="button" value="Previous Page" id="backtopage_ME" onclick="nextpage('SearchManageSubCatogory',null)" class="btn btn-pill btn-outline-primary btn-aprimary" />

                                                    <input type="button" value="Back To Search" id="backtosearch_ME" class="btn btn-pill btn-outline-secondary btn-sm" />*@

                                                <input type="reset" value="Clear" class="btn btn-pill btn-outline-warning btn-awarning" id="clearform" />
                                                <input type="submit" value="Search" id="BtnSearch" class="btn btn-pill btn-outline-primary btn-sm" />
                                                @*<input type="submit" value="Save & Next" id="Save_ME" class="btn btn-pill btn-outline-success btn-auccess" />*@

                                                @*<input type="button" value="Next Page" id="Nextpage_ME" onclick="nextpage('SearchEmployeeAttendence',null)" class="btn btn-pill btn-outline-info btn-air-info" />*@

                                            </div>
                                        </div>
                                    </form>
                                </div>


                            </div>
                        </div>
                        <div class="card" id="DivTblUserSearchresults">
                            @*<h6><span>MANAGE INSTANCE SALARY ATTRIBUTES</span></h6>*@
                            <div class="card-header bg-primary">
                                <h5 class="mb-0">
                                    <button class="btn btn-link collapsed text-white" data-bs-toggle="collapse"> YOUR SEARCH RESULTS <span id="totalrecords_Tranctions_CSA" style=" background-color: white; color: red; font-weight: 900; background-color: white; padding: 5px; border-radius: 16px;"></span> RECORD(S)</button>
                                </h5>
                            </div>

                            <div id="eg1" style="color: black; background-color: whitesmoke">
                                <table class=" table table-bordered" id="TblUserSearchresults" style="background-color: whitesmoke; border-color: red; font-size: 11px;">
                                    <thead>
                                        <tr style="border-color: black;">
                                            <th style=" border-color: blue" class="bg-primary">
                                                S.No
                                            </th>
                                            <th style=" border-color: blue" class="bg-primary">
                                                Name
                                            </th>
                                            <th style="border-color: blue" class="bg-primary">
                                                Role
                                            </th>
                                            <th style="border-color: blue" class="bg-primary">
                                                Class

                                            </th>
                                            <th style=" border-color: blue" class="bg-primary">
                                                Admission Number

                                            </th>
                                            <th style=" border-color: blue" class="bg-primary">
                                                Reg.No./Emp ID

                                            </th>
                                            <th style="border-color: blue; " class="bg-primary">
                                                MobileNumber

                                            </th>

                                        </tr>
                                    </thead>
                                </table>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<div id="appendforinsertsalaryattribute">

</div>

@*<script src="~/Datatable/jquery.dataTables.js"></script>
    <script src="~/Datatable/jquery.dataTables.min.js"></script>*@
@*<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js" type="text/javascript"></script>*@
<script src="https://code.jquery.com/jquery-3.6.2.min.js" integrity="sha256-2krYZKh//PcchRtd+H+VyyQoZ/e3EcrkxhM8ycwASPA=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.11/jquery.validate.unobtrusive.min.js"></script>

<script src="~/lib/jquery/dist/jquery.js" type="text/javascript"></script>
@*@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}*@
@*<script src="~/lib/jquery/dist/jquery.js" type="text/javascript"></script>*@
<script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>

@*<script src="~/lib/jquery/dist/jquery.js"></script>*@
@*<script src="~/js/CommonScripts.js"></script>*@
@*<script src="~/js/PayRoll_1.js"></script>*@
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>

    function setOutTimeAndCheckValidation(callback) {
        var validationmelength = document.getElementById('FmSubjectsSearch').getElementsByClassName('field-validation-error').length;
        debugger;
        if (validationmelength === 0) {
            setTimeout(function () {
                handleValidationZero();
                callback(true); // Call the callback with true indicating success
            }, 50);
        } else {
            $('.alert-danger p').text("Please Enter All Required Fields");
            $(".alert-danger").show().delay(5000).fadeOut();
            callback(false); // Call the callback with false indicating failure
        }
    }

    $(document).ready(function () {
        // Usage
        debugger;
        setOutTimeAndCheckValidation(function (validationResult) {
            debugger;
            if (validationResult) {
                // Your TblDataTableWithColumns_CallingFunction_new call goes inside the if condition
                TblDataTableWithColumns_CallingFunction(event, 'NoStop', '/Users/TblUsersSearch', 'TblUserSearchresults', 'Counts', 'FmUsersSearch', 'DivTblUserSearchresults', '', [], false);
            } else {
                // Handle the case when validation fails, if needed
            }
        });
    });
    $("#FmUsersSearch").submit(function (event) {
        debugger;
        try {
            event.preventDefault();
            $(".ErrorMessageSpan").empty();
            var formElement = document.getElementById('FmUsersSearch');
            setTimeout(function () {
                var validationMessages = formElement.getElementsByClassName('field-validation-error');
                // var validationMessages2 = formElement.getElementsByClassName('error2');
                var validationmelength = validationMessages.length;
                if (validationmelength == 0) {

                    TblDataTableWithColumns_CallingFunction(event, 'NoStop', '/Users/TblUsersSearch', 'TblUserSearchresults', 'Counts', 'FmUsersSearch', 'DivTblUserSearchresults', '', [], false);


                    loaddingimg.css('display', 'none');
                    //  $("#loadingOverlay").hide();
                } else {
                    $('.alert-danger p').text("Pleae Enter All Required Fields");
                    $(".alert-danger").show().delay(5000).fadeOut()
                }
            }, 50);
        } catch (e) {
            // $("#loadingOverlay").hide();
            loaddingimg.css('display', 'none');
            $("#Main_Span_Error").text("Something Error");
        }
    })


    //function searchSalaryAttributes() {

    //    document.getElementById("loading").style.display = "block";
    //    var formData = new FormData($("#FmUsersSearch")[0])
    //    $.ajax({
    //        url: "/PayRoll/SearchSalaryAttributesJson?SalaryAttributeMasterId=" + SalaryAttributeMasterId + "&SalaryAttributeType=" + SalaryAttributeType + '&SalaryAttributeName=' + SalaryAttributeName + '&StartDate=' + StartDate + '&EndDate=' + EndDate + '&IsActive=' + IsActive,
    //        type: "GET",
    //        dataType: "JSON",
    //        success: bindDatatableSEM
    //    });

    //    //--------------------------------------------------------Bind Data into Data Table

    //    function bindDatatableSEM(response) {
    //        //

    //        var formattedDate = GetDateFormat();
    //        //   var num = 0;
    //        var table = $('#tblCSAsearchresults').DataTable();
    //        table.destroy();
    //        $("#totalrecords_Tranctions_CSA").text(response.length);
    //        //  alert("hi1");

    //        var newTable = $("#tblCSAsearchresults").DataTable({
    //            dom: 'Bfrtip',
    //            buttons: [
    //                {
    //                    extend: 'pdfHtml5',
    //                    title: 'CONFIGURE SALARY ATTRIBUTES REPORT',
    //                    message: "Report On: " + formattedDate,
    //                    exportOptions: {
    //                        columns: [1, 2, 3, 4, 5, 6]
    //                    },

    //                }
    //                ,
    //                {
    //                    extend: 'excel',
    //                    title: 'CONFIGURE SALARY ATTRIBUTES REPORT',
    //                    message: "Report On: " + formattedDate,

    //                    exportOptions: {
    //                        columns: [1, 2, 3, 4, 5, 6]
    //                    },



    //                },


    //                {
    //                    extend: 'print',
    //                    title: 'CONFIGURE SALARY ATTRIBUTES REPORT',
    //                    message: "Report On: " + formattedDate,
    //                    exportOptions: {
    //                        columns: [1, 2, 3, 4, 5, 6]
    //                    },
    //                }


    //            ],

    //            bProcessing: false,
    //            bLengthChange: true,
    //            /*  lengthMenu: [[5, 10, 25, -1], [5, 10, 25, "ALL"]],*/
    //            bfilter: false,
    //            bSort: true,
    //            searching: false,
    //            //scrollX: true,
    //            //scrollY: '400px',
    //            /* scrollCollapse: true,*/
    //            paging: true,
    //            bPaginate: true,
    //            //  stateSave:true,
    //            data: response,
    //            columns: [

    //                {
    //                    data: "InstanceSalaryAttributeId",
    //                    visible: false,

    //                    render: function (data, type, row, meta) {
    //                        //  length++;
    //                        return row.instanceSalaryAttributeId
    //                    }
    //                },
    //                {
    //                    targets: 0, // Assuming this is the column index where you want to display numbering
    //                    render: function (data, type, row, meta) {
    //                        var currentPage = table.page.info().page;
    //                        var rowsPerPage = table.page.info().length;
    //                        return (0 * rowsPerPage) + meta.row + 1;
    //                    }
    //                },

    //                {
    //                    data: "SalaryAttributeName",

    //                    render: function (data, type, row, meta) {
    //                        //  length++;

    //                        return row.salaryAttributeName

    //                    }
    //                },
    //                {
    //                    data: "SalaryAttributeType",

    //                    render: function (data, type, row, meta) {
    //                        //  length++;

    //                        return row.salaryAttributeType

    //                    }
    //                },
    //                {
    //                    data: "StartDate",

    //                    render: function (data, type, row, meta) {
    //                        //  length++;
    //                        var startDate = new Date(row.startDate);

    //                        return startDate.toLocaleDateString();


    //                    }
    //                },
    //                {
    //                    data: "EndDate",

    //                    render: function (data, type, row, meta) {
    //                        var endDate = new Date(row.endDate);

    //                        return endDate.toLocaleDateString();

    //                    }
    //                }
    //                ,
    //                {
    //                    data: "IsActive",

    //                    render: function (data, type, row, meta) {


    //                        return row.isActive;

    //                    }
    //                },
    //                {

    //                    render: function (data, type, row, meta) {
    //                        //  length++;

    //                        return '<i class="fa fa-trash-o" style="color:red;font-size: 23px;margin-top:3%;cursor: pointer;" title="Delete"><input type="text" value=' + row.instanceSalaryAttributeId + ' hidden/></i>'

    //                    }
    //                }
    //            ]


    //        });
    //        newTable.page(tabletargetpagetblSEMsearchresults).draw('page');
    //        table.on('draw', function () {
    //            $('#tblCSAsearchresults').find('td:nth-child(2)').attr('title', 'Edit');
    //        });
    //        $('#tblCSAsearchresults').find('td:nth-child(2)').attr('title', 'Edit');
    //        loaddingimg.css('display', 'none');
    //    }
    //}
</script>