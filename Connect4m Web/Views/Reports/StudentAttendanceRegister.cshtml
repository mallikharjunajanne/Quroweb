@model Connect4m_Web.Models.Attendenceproperites.Attendanceregisterreport

@{

    Layout = "~/Views/Shared/_Layout.cshtml";
}



<!DOCTYPE html>
<html>
<head>
    <style>
        .S_btn {
            width: 7%;
            height: 28px;
            margin-left: 19%;
        }

        .Dropdownbox {
            width: 191px;
            height: 23px;
            border: 2px solid #999;
            font-size: 15px;
            color: brown;
            background-color: azure;
            border-radius: 5px;
        }


        /*Image Popup Show Styles*/

        .ScreenShotImage span {
            display: none;
            position: absolute;
            z-index: 1;
        }

        .ScreenShotImage:hover span {
            display: inline-block;
        }

        .ScreenShotImage {
            position: relative;
        }

            .ScreenShotImage:hover::before {
                display: none;
                position: absolute;
            }



        #myTable .Table_report {
            border: 1px solid green;
            border-width: thin;
            border-style: double;
            font-size: 10px;
            font-weight: 800;
        }

        #myTable thead, #myTable tbody, #myTable tfoot, #myTable tr, #myTable td, #myTable th {
            border: 1px solid !important;
            font-weight: 700;
        }

        .Table_report thead {
            font-size: 10px;
            background-color: #ADDFFF;
            color: #000000;
        }

        .Table_report tbody {
            font-size: 10px;
        }

        #myTbl .Table_Avgreport {
            border: 1px solid green;
            border-width: thin;
            border-style: double;
            font-size: 10px;
            font-weight: 800;
        }

        #myTbl thead, #myTbl tbody, #myTbl tfoot, #myTbl tr, #myTbl td, #myTbl th {
            border: 1px solid !important;
            font-weight: 700;
        }

        .Table_Avgreport thead {
            font-size: 10px;
            /* background-color: #ADDFFF;*/
            color: #000000;
        }

        .Table_Avgreport tbody {
            font-size: 10px;
        }
    </style>
    <link rel="stylesheet" href="~/css/print.css" media="print" />
    <style>
        /* Page styles */
        @@media print {
            /* Define print-specific styles here */
            body {
                margin: 0;
                padding: 0;
                size: A4 portrait; /* or size: A4 landscape; */
            }
            /* Add more styles as needed for your layout and paper size */
        }

        /* Print styles */
        #myTable .Table_report {
            border: 1px solid green;
            border-width: thin;
            border-style: double;
            font-size: 10px;
            font-weight: 800;
        }

        #myTable thead,
        #myTable tbody,
        #myTable tfoot,
        #myTable tr,
        #myTable td,
        #myTable th {
            border: 1px solid !important;
            font-weight: 700;
        }

        .Table_report thead {
            font-size: 10px;
            background-color: #ADDFFF;
            color: #000000;
        }

        .Table_report tbody {
            font-size: 10px;
        }

        #myTbl .Table_Avgreport {
            border: 1px solid green;
            border-width: thin;
            border-style: double;
            font-size: 10px;
            font-weight: 800;
        }

        #myTbl thead,
        #myTbl tbody,
        #myTbl tfoot,
        #myTbl tr,
        #myTbl td,
        #myTbl th {
            border: 1px solid !important;
            font-weight: 700;
        }

        .Table_Avgreport thead {
            font-size: 10px;
            /* background-color: #ADDFFF;*/
            color: #000000;
        }

        .Table_Avgreport tbody {
            font-size: 10px;
        }

        .Table_report td,
        .Table_report th {
            word-break: normal;
        }
    </style>




</head>
<body>
    <div class="flex-grow-1 container-p-y container-xxl">
        <h4 class="py-3 mb-4"><span class="text-muted fw-light">Reports /</span>STUDENT REGISTER </h4>
        <div class="row mb-2">
            <div class="col-md-12 col-lg-12 mb-3">
                <span class="text-danger" id="Errormessage"></span>
                <div class="card mb-4">
                    <div class="card-header d-flex align-items-center justify-content-between">
                        <h5 class="mb-0">
                            SEARCH STUDENT REGISTER
                        </h5> <small class="text-muted float-end">* INDICATES MANDATORY FIELD</small>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <form id="Attendanceregisterreportform">
                                    <div class="row mb-3">
                                        <label asp-for="Month" class="control-label col-sm-4 col-form-label text-end required space">Month</label>
                                        <div class="col-sm-4">
                                            <div class="position-relative">
                                                <select class="select2 form-select select2-hidden-accessible" id="Monthddl" asp-for="Month">
                                                    <option value="">---------Select---------</option>
                                                    <option value="01">January</option>
                                                    <option value="02">February</option>
                                                    <option value="03">March</option>
                                                    <option value="04">April</option>
                                                    <option value="05">May</option>
                                                    <option value="06">June</option>
                                                    <option value="07">July</option>
                                                    <option value="08">August</option>
                                                    <option value="09">September</option>
                                                    <option value="10">October</option>
                                                    <option value="11">November</option>
                                                    <option value="12">December</option>
                                                </select>
                                                <span asp-validation-for="Month" class="text-danger"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label asp-for="Year" class="control-label col-sm-4 col-form-label text-end required space">Year</label>
                                        <div class="col-sm-4">
                                            <div class="position-relative">
                                                <select class="select2 form-select select2-hidden-accessible" id="Yearddl" asp-for="Year">
                                                    <option value="">---------Select---------</option>
                                                    <option value="2010">2010</option>
                                                    <option value="2011">2011</option>
                                                    <option value="2012">2012</option>
                                                    <option value="2013">2013</option>
                                                    <option value="2014">2014</option>
                                                    <option value="2015">2015</option>
                                                    <option value="2016">2016</option>
                                                    <option value="2017">2017</option>
                                                    <option value="2018">2018</option>
                                                    <option value="2019">2019</option>
                                                    <option value="2020">2020</option>
                                                    <option value="2021">2021</option>
                                                    <option value="2022">2022</option>
                                                    <option value="2023">2023</option>
                                                    <option value="2024">2024</option>
                                                </select>
                                                <span asp-validation-for="Month" class="text-danger"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label asp-for="InstanceClassificationId" class="control-label col-sm-4 col-form-label text-end required space">Department</label>
                                        <div class="col-sm-4">
                                            <div class="position-relative">
                                                <select class="select2 form-select select2-hidden-accessible" id="Ddldepartment" asp-for="InstanceClassificationId">
                                                </select>
                                                <span asp-validation-for="InstanceClassificationId" class="text-danger"></span>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label asp-for="InstanceSubClassificationId" class="control-label col-sm-4 col-form-label text-end required space">Class</label>
                                        <div class="col-sm-4">
                                            <div class="position-relative">
                                                <select class="select2 form-select select2-hidden-accessible" id="DdlSubClass" asp-for="InstanceSubClassificationId">
                                                </select>
                                                <span asp-validation-for="InstanceSubClassificationId" class="text-danger"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row justify-content text-center">
                                        <div class="col-sm-12">
                                            <button type="reset" class="btn btn-warning waves-effect waves-light" onclick="CommonClearFunction('Summerydetails')" id="BtnClear">Clear</button>
                                            <button type="submit" class="btn btn-success waves-effect waves-light">Search </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="Registertablediv1" style="display:none;">
            <div class="row mb-2">
                <div class="col-md-12 col-lg-12 mb-3">
                    <div class="card mb-4">
                        <div class="card-header d-flex align-items-center justify-content-between">
                            <h5 class="mb-0">
                                STEPS TO BE FOLLOWED TO TAKE PRINT
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col">
                                    <table width="100%" cellpadding="0" cellspacing="0" align="center" class="tablesideborders">
                                        <tbody>
                                            <tr>
                                                <td style="height: 24px;">
                                                    <table cellpadding="0" id="tblinstructions" width="100%" cellspacing="0">
                                                        <tbody>
                                                            <tr>
                                                                <td width="24%">
                                                                    &nbsp;<b>Step 1:-</b>&nbsp;
                                                                    <a class="ScreenShotImage" href="#">
                                                                        (<u>View screenshot</u>)
                                                                        <span>
                                                                            <img id="screenshotImage1" src="~/Images/Print1.jpg" width="302px" height="237px" alt="" style="border: 1px solid #cbcbcb;">
                                                                        </span>
                                                                    </a>
                                                                </td>
                                                                <td>
                                                                    <label>Click on "Preferences" button on General Tab of Print window.</label>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td width="24%">
                                                                    &nbsp;<b>Step 2:-</b>&nbsp;
                                                                    <a class="ScreenShotImage" href="#">
                                                                        (<u>View screenshot</u>)
                                                                        <span>
                                                                            <img id="screenshotImage2" src="../Images/Print2.jpg" width="302px" height="237px" alt="" style="border: 1px solid #cbcbcb;"><br>
                                                                        </span>
                                                                    </a>
                                                                </td>
                                                                <td>
                                                                    <label>Click on "Orientation" Dropdown and select "Landscape" option.</label>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td width="24%">
                                                                    &nbsp;<b>Step 3:-</b>&nbsp;
                                                                    <a class="ScreenShotImage" href="#">
                                                                        (<u>View screenshot</u>)
                                                                        <span>
                                                                            <img id="screenshotImage3" src="~/Images/Print.jpg" width="302px" height="237px" alt="" style="border: 1px solid #cbcbcb;"><br>
                                                                        </span>
                                                                    </a>
                                                                </td>
                                                                <td>
                                                                    <label>Adjust left and right margins by clicking print preview option.</label>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            @*<div id="EXcel_Print_btns" style="display: flex; grid-gap: 16px;">
                    <a href="#" id="exportButton" value="Export To Excel" style="font-weight: bold; margin-left: 18px;">Export To Excel</a>
                    <a href="#" id="printButton" style="margin-left: 78%; font-weight: bold;">Print</a>
                </div>*@
            <div class="row justify-content" id="EXcel_Print_btns">
                <div class="col-sm-6">
                    <button type="button" id="exportButton" class="btn btn-pill btn-outline-info btn-air-info">Export To Excel</button>

                </div>
                <div class="col-sm-6 text-end " id="Getmonthwiseattendnacetblmain">
                    <button type="button" id="printButton" class="btn btn-pill btn-outline-info btn-air-info">Print</button>
                </div>
            </div>


            <!--<div id="EXcel_Print_btns" style="display: flex; grid-gap: 16px;">-->
            @*<input type="button" value="Export Excel" title="Export Excel" class="btn btn-pill btn-outline-info btn-air-info" id="exportButton">
                <input type="button" value="PRINT" title="Print" class="btn btn-pill btn-outline-info btn-air-info" id="printButton">*@
            <!--<button type="button" id="exportButton" class="btn btn-pill btn-outline-info btn-air-info">Export To Excel</button>
                <button type="button" id="printButton" class="btn btn-pill btn-outline-info btn-air-info">Print</button>

            </div>-->

            <div class="card">
                @*<div class="card-header pb-0">
                        <div style=" font-size: 20px; text-align: center;">
                            <h1 style="background-color: white; color: darkorange; font-weight: 700; font-size: 25px; margin-top: -13px;">STUDENT REGISTER</h1>
                        </div>
                    </div>*@
                @*<div style="color:red; font-size:13px;">
                        <div id="validation2" style="color: red;"></div>
                        <div id="validationMessage" style="color: red;"></div>
                    </div>*@
                <!--<div class="card-body">
                <div class="default-according style-1">
                    <div class="card">-->
                @*<div style="color: red; font-size: 13px;">
                        <p style="font-size: 12px;"></p>

                    </div>
                    <div class="card-header bg-primary">
                        <h5 class="mb-0">
                            <button class="btn btn-link text-white collapsed" data-bs-toggle="collapse" data-bs-target="#collapseicon" aria-expanded="true" aria-controls="collapse11" style="background-color: tomato;"><i class="icofont icofont-student-alt"></i>SEARCH STUDENT REGISTER</button>
                        </h5>
                    </div>*@
                <!--<div class="collapse show" id="collapseicon" aria-labelledby="collapseicon" data-bs-parent="#accordionoc" style="">
                                <div class="card-body">
                                    <form id="myForm">
                                        <div class="form-group row">
                                            <label asp-for="Month" class="col-sm-3 col-form-label"><font style=" color: red; font-size: 13px;"><b>*</b></font>Month :</label>
                                            <div class="col-sm-9">
                                                <select asp-for="Month" class="Dropdownbox" id="Month">
                                                    <option value="">---------Select---------</option>
                                                    <option value="01">January</option>
                                                    <option value="02">February</option>
                                                    <option value="03">March</option>
                                                    <option value="04">April</option>
                                                    <option value="05">May</option>
                                                    <option value="06">June</option>
                                                    <option value="07">July</option>
                                                    <option value="08">August</option>
                                                    <option value="09">September</option>
                                                    <option value="10">October</option>
                                                    <option value="11">November</option>
                                                    <option value="12">December</option>
                                                </select>
                                                <span id="MonthError" style="color: red; font-size: 13px;"></span>
                                            </div>

                                            <label asp-for="Year" class="col-sm-3 col-form-label"><font style=" color: red; font-size: 13px;"><b>*</b></font>Year :</label>
                                            <div class="col-sm-9">
                                                <select asp-for="Year" class="Dropdownbox" id="Year">
                                                    <option value="">---------Select---------</option>
                                                    <option value="2010">2010</option>
                                                    <option value="2011">2011</option>
                                                    <option value="2012">2012</option>
                                                    <option value="2013">2013</option>
                                                    <option value="2014">2014</option>
                                                    <option value="2015">2015</option>
                                                    <option value="2016">2016</option>
                                                    <option value="2017">2017</option>
                                                    <option value="2018">2018</option>
                                                    <option value="2019">2019</option>
                                                    <option value="2020">2020</option>
                                                    <option value="2021">2021</option>
                                                    <option value="2022">2022</option>
                                                    <option value="2023">2023</option>
                                                </select>
                                                <span id="YearError" style="color: red; font-size: 13px;"></span>
                                            </div>

                                            <label asp-for="ClassificationName" class="col-sm-3 col-form-label"><font style=" color: red; font-size: 13px;"><b>*</b></font>Department :</label>
                                            <div class="col-sm-9" id="Str_DP_ID">
                                                  <span id="DepartmentError" style="color: red; font-size: 13px;"></span>
                                            </div>

                                            <label asp-for="SubClassificationName" class="col-sm-3 col-form-label"><font style=" color: red; font-size: 13px;"><b>*</b></font>Class :</label>
                                            <div class="col-sm-9">
                                                 <span id="ClassError" style="color: red; font-size: 13px;"></span>
                                            </div>

                                            <div class="S_btn" style="display: flex; grid-gap: 16px;">
                                                <input type="reset" value="Clear" />
                                                <input type="submit" value="Search" />
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>-->
            </div>


            @*register_ViewId*@
            @*<div class="card-body">
                    <div class="default-according style-1">
                        <div class="card">
                            <div style="color: red; font-size: 13px;">
                                <p style="font-size: 12px;"></p>

                            </div>
                            <div class="card-header bg-primary">
                                <h5 class="mb-0">
                                    <button class="btn btn-link text-white collapsed" data-bs-toggle="collapse" data-bs-target="#collapseicon" aria-expanded="true" aria-controls="collapse11" style="background-color: tomato;">STEPS TO BE FOLLOWED TO TAKE PRINT</button>
                                </h5>
                            </div>
                            <div class="collapse show" id="collapseicon" aria-labelledby="collapseicon" data-bs-parent="#accordionoc" style="">
                                <div class="card-body">
                                    <table width="100%" cellpadding="0" cellspacing="0" align="center" class="tablesideborders">
                                        <tbody>
                                            <tr>
                                                <td style="height: 24px;">
                                                    <table cellpadding="0" id="tblinstructions" width="100%" cellspacing="0">
                                                        <tbody>
                                                            <tr>
                                                                <td width="24%">
                                                                    &nbsp;<b>Step 1:-</b>&nbsp;
                                                                    <a class="ScreenShotImage" href="#">
                                                                        (<u>View screenshot</u>)
                                                                        <span>
                                                                            <img id="screenshotImage1" src="~/Images/Print1.jpg" width="302px" height="237px" alt="" style="border: 1px solid #cbcbcb;">
                                                                        </span>
                                                                    </a>
                                                                </td>
                                                                <td>
                                                                    <b style="font-size: 12px;">Click on "Preferences" button on General Tab of Print window.</b>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td width="24%">
                                                                    &nbsp;<b>Step 2:-</b>&nbsp;
                                                                    <a class="ScreenShotImage" href="#">
                                                                        (<u>View screenshot</u>)
                                                                        <span>
                                                                            <img id="screenshotImage2" src="../Images/Print2.jpg" width="302px" height="237px" alt="" style="border: 1px solid #cbcbcb;"><br>
                                                                        </span>
                                                                    </a>
                                                                </td>
                                                                <td>
                                                                    <b style="font-size: 12px;">Click on "Orientation" Dropdown and select "Landscape" option.</b>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td width="24%">
                                                                    &nbsp;<b>Step 3:-</b>&nbsp;
                                                                    <a class="ScreenShotImage" href="#">
                                                                        (<u>View screenshot</u>)
                                                                        <span>
                                                                            <img id="screenshotImage3" src="~/Images/Print.jpg" width="302px" height="237px" alt="" style="border: 1px solid #cbcbcb;"><br>
                                                                        </span>
                                                                    </a>
                                                                </td>
                                                                <td>
                                                                    <b style="font-size: 12px;">Adjust left and right margins by clicking print preview option.</b>
                                                                </td>
                                                            </tr>


                                                        </tbody>
                                                    </table>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>*@

            @*<div id="EXcel_Print_btns" style="display: flex; grid-gap: 16px;">

                    <a href="#" id="exportButton" value="Export To Excel" style="font-weight: bold; margin-left: 18px;">Export To Excel</a>

                    <a href="#" id="printButton" style="margin-left: 78%; font-weight: bold;">Print</a>


                </div>*@

            <div class="row mb-2">
                <div class="col-md-12 col-lg-12 mb-3">
                    <div class="card mb-4">
                        <div class="card-header d-flex align-items-center justify-content-between">
                            <h5 class="mb-0">
                                <span>
                                    ATTENDANCE DETAILS
                                </span>
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="card-datatable text-nowrap">
                                <div class="table-responsive">
                                    <div class="table-responsive text-nowrap" id="printDiv">
                                        <table width="100%" border="0" style="background-color: white; color: slateblue; font-weight: bolder; background-color: white; color: slateblue; font-weight: bolder;">
                                            <tbody>
                                                <tr>
                                                    <td align="left" colspan="3" style="font-size:12px;font-weight:color:#000000;">
                                                        <b>Note: </b>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td align="left" style="font-size:10px;font-weight:200;">
                                                        <ul>
                                                            <li> P-- Present </li>
                                                            <li> A-- Absent </li>
                                                            <li> OS-- Out of Station </li>
                                                            <li> UW-- Urgent Work </li>
                                                            <li> OL-- Official Leave </li>


                                                        </ul>
                                                    </td>
                                                    <td align="left" style="font-size:10px;font-weight:200;">
                                                        <ul>

                                                            <li> DA-- Doctor Appointment  </li>
                                                            <li> NA-- No Application </li>
                                                            <li> NE-- No Examination </li>

                                                            <li> PL-- Preparatory Leave </li>
                                                            <li> UFR-- Urgent Family Reason  </li>
                                                        </ul>
                                                    </td>
                                                    <td align="left" style="font-size:10px;font-weight:200;">
                                                        <ul>
                                                            <li> 1HP-- First half Present </li>
                                                            <li> 2HP-- Second half Present </li>
                                                            <li> IL-- Illness </li>
                                                            <li> O-- Others </li>
                                                        </ul>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>

                                        <div class="header" style=" text-align: center; margin-left: 27%; font-weight: 500;">
                                            <b>ADS SCHOOL</b>
                                            <p>Student Attendance Register for the Month of  <span id="MONTHIDMONTHID"></span>,<span id="YEARID"></span>  </p>
                                            <p>Class : <span id="Cl"></span>      , Section: <span id="Section"></span>       , No-Of Teaching Days: <span id="Teaching_Days"></span></p>
                                        </div>

                                        <table class="" id="Attendancereporttbl" style="border-collapse:separate;">
                                            <thead class="" id="tblhead">

                                            </thead>
                                            <tbody id="tblBody">
                                            </tbody>
                                            <tfoot id="tblfooter">

                                            </tfoot>
                                        </table>
                                        <br />
                                        <table id="myTbl">
                                            <thead>
                                                <tr><th colspan="2">Average Attendacne for the month</th></tr>
                                                <tr>
                                                    <th>Category of Student</th>
                                                    <th>Average Attendance Rate</th>
                                                </tr>
                                            </thead>
                                            <tbody id="AvgTblbody">
                                            </tbody>
                                        </table>

                                        @*<table id="myTable" class="Table_report">
                                            <thead class="border-0" id="tablehead">

                                            </thead>
                                            <tbody id="tableBody">
                                            </tbody>
                                            <tfoot id="tablefooter">
                                            <tr>
                                            <td colspan="50" style="font-size: 10px; font-weight: bold; color: #000000;">&nbsp;</td>
                                            </tr>
                                            </tfoot>
                                            </table>

                                            <table>
                                            <tbody id="Student_Absentes">
                                            </tbody>
                                            </table>*@

                                        <div id="Signaturediv">

                                        </div>
                                        @*<div style="margin-left: 60%; position: absolute; margin-top: -12%;">
                                                <span>Signature of Teacher________________________</span>
                                            </div>*@
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>



<script src="~/lib/jquery/dist/jquery.js"></script>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.13.0/jquery-ui.min.js"></script>
<script src="~/lib/jquery/dist/jquery.js" type="text/javascript"></script>

<script src="~/js/Student_Attendance_register.js"></script>

<!-- Make sure to place this script tag after the definition of printDiv -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}




<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.1/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.4/xlsx.full.min.js"></script>

